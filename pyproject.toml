# ==============================================================================
#  构建系统配置
# ==============================================================================
[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"


# ==============================================================================
#  项目元数据与依赖 (Poetry 配置)
# ==============================================================================
[tool.poetry]
name = "trans-hub"
version = "2.0.0"
description = "一个可嵌入的、带持久化存储的智能本地化（i18n）后端引擎。"
authors = ["Saken <saken.w@gmail.com>"]
license = "MIT"
readme = "README.md"

homepage = "https://github.com/SakenW/trans-hub"
repository = "https://github.com/SakenW/trans-hub"
documentation = "https://github.com/SakenW/trans-hub/blob/main/README.md"

classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Topic :: Software Development :: Localization",
    "Topic :: Text Processing",
]

# --- 核心依赖 ---
[tool.poetry.dependencies]
python = ">=3.9, <3.14"
pydantic = "^2.0"
structlog = "^23.0"
translators = "^6.0.1"
pydantic-settings = "^2.3.4"
python-dotenv = "^1.0.1"
aiosqlite = "^0.20.0"
cachetools = "^5.3.3"


# --- 可选依赖 (Extras) ---
[tool.poetry.extras]
openai = ["openai"]


# ==============================================================================
#  开发依赖
# ==============================================================================
[tool.poetry.group.dev.dependencies]
# 测试
pytest = "^7.4"
pytest-cov = "^4.1"
pytest-asyncio = "^0.21.0"

# 代码质量
ruff = "^0.4.0"
mypy = "^1.5"

# 可选功能测试
openai = "^1.37.0"
types-cachetools = "^5.3.1"


# ==============================================================================
#  开发工具统一配置
# ==============================================================================

# --- Ruff ---
[tool.ruff]
line-length = 88
target-version = "py39"

[tool.ruff.lint]
select = ["E", "W", "F", "I", "N", "D", "UP", "B", "C4"]
# --- 核心修正：优化忽略列表 ---
ignore = [
    "E501",   # line too long, handled by formatter
    # 忽略“缺少文档字符串”的规则，因为我们不要求所有函数都有
    "D100",   # Missing docstring in public module
    "D101",   # Missing docstring in public class
    "D102",   # Missing docstring in public method
    "D103",   # Missing docstring in public function
    "D104",   # Missing docstring in public package
    "D105",   # Missing docstring in magic method
    "D107",   # Missing docstring in `__init__`
    # 忽略一些主观性较强的文档字符串格式规则
    "D205",   # 1 blank line required between summary line and description
    "D400",   # First line should end with a period
    "D415",   # First line should end with a period, question mark, or exclamation point
    # 添加这些以消除配置警告
    "D203",
    "D213",
]

# --- MyPy ---
[tool.mypy]
python_version = "3.9"
warn_return_any = true
warn_unused_configs = true
ignore_missing_imports = true
strict_optional = true
show_error_codes = true
pretty = true