# 多语言文档支持

Trans-Hub 项目支持多语言文档，使用 Sphinx 的国际化 (i18n) 功能实现。本指南将介绍如何生成、翻译和构建多语言文档。

## 配置国际化

项目的 `docs/conf.py` 文件已经配置了基本的国际化支持：

```python
# -- 国际化 (i18n) 配置 ------------------------------------------------
language = "zh_CN"
locale_dirs = ["locale/"]
gettext_compact = False
```

- `language`: 默认语言，这里设置为中文
- `locale_dirs`: 翻译文件存储目录
- `gettext_compact`: 是否将所有翻译合并到一个文件中

## 生成 POT 文件

POT (Portable Object Template) 文件是翻译的模板文件，包含需要翻译的文本。生成命令：

```bash
cd docs
make gettext
```

生成的 POT 文件会保存在 `docs/_build/gettext` 目录下。

## 创建语言翻译

### 初始化特定语言的翻译

以英文为例：

```bash
sphinx-intl update -p _build/gettext -l en
```

这会在 `docs/locale/en/LC_MESSAGES` 目录下生成 PO 文件。

### 翻译 PO 文件

使用文本编辑器打开 PO 文件，翻译其中的内容。每个需要翻译的文本都有一个 `msgid` 和对应的 `msgstr` 字段，在 `msgstr` 中填写翻译后的内容。

例如：

```po
msgid "配置模型 (Config)"
msgstr "Configuration Model"
```

## 构建多语言文档

### 构建特定语言的文档

```bash
# 构建英文文档
make -e SPHINXOPTS="-D language='en'" html
```

构建后的文档会保存在 `docs/_build/html` 目录下。

### 同时构建多种语言的文档

可以创建一个脚本文件来同时构建多种语言的文档：

```bash
#!/bin/bash
# build_docs.sh

# 构建中文文档
make html

# 构建英文文档
make -e SPHINXOPTS="-D language='en'" html

# 复制英文文档到单独的目录
cp -r _build/html _build/html_en

# 重新构建中文文档
make html
```

## 添加语言切换功能

为了让用户能够在不同语言的文档之间切换，可以添加一个语言切换器。

### 修改 HTML 模板

1. 创建 `docs/_templates` 目录（如果不存在）
2. 在该目录下创建 `layout.html` 文件，内容如下：

```html
{% extends "!layout.html" %}

{% block footer %}
  {{ super() }}
  <div class="language-switcher">
    <h3>语言 / Language</h3>
    <ul>
      <li><a href="{{ pathto(root_doc) }}">中文</a></li>
      <li><a href="../html_en/{{ pathto(root_doc) }}">English</a></li>
    </ul>
  </div>
  <style>
    .language-switcher {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .language-switcher ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    .language-switcher li {
      margin: 5px 0;
    }
  </style>
{% endblock %}
```

## 支持更多语言

要支持更多语言，只需重复上述步骤：

1. 初始化新语言的翻译：`sphinx-intl update -p _build/gettext -l <language_code>`
2. 翻译生成的 PO 文件
3. 构建该语言的文档
4. 更新语言切换器

## 最佳实践

1. 保持翻译的一致性和准确性
2. 在提交代码时，同时提交更新的 POT 和 PO 文件
3. 为每种语言维护独立的文档构建目录
4. 定期更新翻译以同步最新的文档变更

通过以上步骤，您可以为 Trans-Hub 项目提供完善的多语言文档支持。